###############################################################################
# yum.lib                                                  Version : 1.1.2.2  #
#                                                                             #
# Creation Date : 04/01/2016                                                  #
# Team          : Only me after all                                           #
# Support mail  : arnaud@crampet.net                                          #
# Author        : Arnaud Crampet                                              #
#                                                                             #
# Subject : This library provide base runtime to manage yum                   #
#                                                                             #
###############################################################################
####
# INFO 
 


function yum_Install_Package
{
#|# yum_to_DELETE        : this var is used to selecte which yum to delete  
############ STACK_TRACE_BUILDER #####################
Function_Name="$0"
Function_PATH="${Function_PATH}/${Function_Name}"
######################################################
MSG_DISPLAY "Debug6" "Current Stack : [ ${Function_PATH} ] "

YumPackageToInstall=${1}
Empty_Var_Control "${YumPackageToInstall}" "YumPackageToInstall" "ErrorN" "2" "package name is a mandatory parameter "
yum_check_Package ${YumPackageToInstall}
if [ "${YumPackageStatus}" = "NOT INSTALLED" ] 
then 
	yum install -y ${YumPackageToInstall}
	CTRL_Result_func "${?}" "status for package : [ ${YumPackageToCheck}] " "Not Installed" "4" "" ""
else
	MSG_DISPLAY "Debug" "Package ${YumPackageStatus} : [ INSTALLED ] "
fi

############### Stack_TRACE_BUILDER ################
Function_PATH="$( dirname ${Function_PATH} )"
#################################################### 
} 


function yum_UnInstall_Package
{
#|# yum_to_DELETE        : this var is used to selecte which yum to delete  
############ STACK_TRACE_BUILDER #####################
Function_Name="$0"
Function_PATH="${Function_PATH}/${Function_Name}"
######################################################
MSG_DISPLAY "Debug6" "Current Stack : [ ${Function_PATH} ] "

YumPackageToUnInstall=${1}
yum_check_Package ${YumPackageToUnInstall}
if [ "${YumPackageStatus}" = "INSTALLED" ] 
then 
	yum erase -y ${YumPackageToUnInstall}
	CTRL_Result_func "${?}" "status for package : [ ${YumPackageToUnInstall}] " "Can t uninstall" "4" "" ""
else
	MSG_DISPLAY "Debug" "Package ${YumPackageStatus} : [ NOT INSTALLED ] "
fi

############### Stack_TRACE_BUILDER ################
Function_PATH="$( dirname ${Function_PATH} )"
#################################################### 
} 


function yum_check_Package
{
#|# Var to set  : YumPackageToCheck             
#|#
#|# Base usage  : Cyum_check_Package PackageName
#|#
#|# Description : This function Check package instalation status.
#|#
#|# Send Back   : Info and action ( execution of other fcntion to set many information about the system) 
############ STACK_TRACE_BUILDER #####################
Function_Name="$0"
Function_PATH="${Function_PATH}/${Function_Name}"
######################################################
MSG_DISPLAY "Debug6" "Current Stack : [ ${Function_PATH} ] "

YumPackageToCheck=${1}


Empty_Var_Control "${YumPackageToCheck}" "YumPackageToCheck" "ErrorN" "2" "package name is a mandatory parameter "
yum list installed ${YumPackageToCheck} -q 2> /dev/null
CTRL_Result_func "${?}" "status for package : [ ${YumPackageToCheck}] " "Not Installed" "0"  "yum_check_Package_sub_u" "yum_check_Package_sub_i" 


############### Stack_TRACE_BUILDER ################
Function_PATH="$( dirname ${Function_PATH} )"
#################################################### 
} 


function Find_inArray
{
#|# yum_to_DELETE        : this var is used to selecte which yum to delete
############ STACK_TRACE_BUILDER #####################
Function_Name="$0"
Function_PATH="${Function_PATH}/${Function_Name}"
######################################################
MSG_DISPLAY "Debug6" "Current Stack : [ ${Function_PATH} ] "

ArrayToSearchIn="${1}"	
ElementToFind="${2}"

for Itms in ${ArrayToSearchIn} 
do
	 

############### Stack_TRACE_BUILDER ################
Function_PATH="$( dirname ${Function_PATH} )"
#################################################### 
}


function yum_check_Package_sub_i
{
#|# yum_to_DELETE        : this var is used to selecte which yum to delete
############ STACK_TRACE_BUILDER #####################
Function_Name="$0"
Function_PATH="${Function_PATH}/${Function_Name}"
######################################################
MSG_DISPLAY "Debug6" "Current Stack : [ ${Function_PATH} ] "

YumPackageStatus="INSTALLED"

############### Stack_TRACE_BUILDER ################
Function_PATH="$( dirname ${Function_PATH} )"
####################################################
}

function yum_check_Package_sub_u
{
#|# yum_to_DELETE        : this var is used to selecte which yum to delete
############ STACK_TRACE_BUILDER #####################
Function_Name="$0"
Function_PATH="${Function_PATH}/${Function_Name}"
######################################################
MSG_DISPLAY "Debug6" "Current Stack : [ ${Function_PATH} ] "

YumPackageStatus="NOT INSTALLED"

############### Stack_TRACE_BUILDER ################
Function_PATH="$( dirname ${Function_PATH} )"
####################################################
}

function yum_init_Package_List
{
#|# yum_to_DELETE        : this var is used to selecte which yum to delete
############ STACK_TRACE_BUILDER #####################
Function_Name="$0"
Function_PATH="${Function_PATH}/${Function_Name}"
######################################################
MSG_DISPLAY "Debug6" "Current Stack : [ ${Function_PATH} ] "

set -A PackageList 

PackageList=$( yum  list installed | awk '{ print $1}')


############### Stack_TRACE_BUILDER ################
Function_PATH="$( dirname ${Function_PATH} )"
####################################################
}

Sourced_OK="1"   
