###############################################################################
# Compile_menu.lib                                          Version : 1.1.2.2 #
#                                                                             #
# Creation Date : 04/01/2007                                                  #
# Team          : **************************************                      #
# Support mail  : arnaud@crampet.net                                           #
# Author        : Arnaud Crampet                                              #
#                                                                             #
# Subject : This library provide base Generics function for packages install  #
#           menu generate                                                     #
###############################################################################
####
# INFO

function Install_package                                 # Compile_Base_MENU_L0
{
#|# Var to set  : None
#|#
#|# Base usage  : PKG_INSTALL_Menu
#|#
#|# Description : This function is used to create Base package installation menu
#|#
#|# Send Back   :  menu
#|#
#|#
############ STACK_TRACE_BUILDER #####################
Function_Name="$0"
Function_PATH="${Function_PATH}/${Function_Name}"
######################################################
MSG_DISPLAY "Debug4" "Current Stack : [ ${Function_PATH} ] "

Menu_Get_items "# PKG_installable_ok" "2" "${Base_Dir_Scripts_Lib}/build/pkg_install.lib" "Install package menu :"

############### Stack_TRACE_BUILDER ################
Function_PATH="$( dirname ${Function_PATH} )"
####################################################
}


function PKG_INSTALL_config                      # PKG_installable_ok
{
#|# Var to set  : None
#|#
#|# Base usage  : PKG_INSTALL_config
#|#
#|# Description : This function is used to create change menu for http get location parameter
#|#
#|# Send Back   : Configuration menu
#|#
############ STACK_TRACE_BUILDER #####################
Function_Name="$0"
Function_PATH="${Function_PATH}/${Function_Name}"
######################################################
MSG_DISPLAY "Debug4" "Current Stack : [ ${Function_PATH} ] "
PKG_INSTALL_CTRL_Sourcing_PKG_CONF
set -A Configuration_install_pkg 'Menu Configuration:'                       \
     'CHANGE Base_Dir_prefix_install=[${Base_Dir_prefix_install}]'           \
     'CHANGE EXTERNAL_ONLY_GET=[${EXTERNAL_ONLY_GET}]'                       \
     'packages_version_config'                                               \
     'Packages_URL_config'

Menu_Build Configuration_install_pkg
############### Stack_TRACE_BUILDER ################
Function_PATH="$( dirname ${Function_PATH} )"
####################################################
}

function packages_version_config
{
#|# Var to set  : None
#|#
#|# Base usage  : packages_version_config
#|#
#|# Description : This function is used to create change menu package version parameter
#|#
#|# Send Back   : Configuration menu
#|#
############ STACK_TRACE_BUILDER #####################
Function_Name="$0"
Function_PATH="${Function_PATH}/${Function_Name}"
######################################################
MSG_DISPLAY "Debug4" "Current Stack : [ ${Function_PATH} ] "
PKG_LST=""
MSG_DISPLAY "Debug5"  "Used Configuration file : [ ${Base_Dir_Scripts_CNF}/${Package_Configuration_File}]"
for PKS_versions in $( cat ${Base_Dir_Scripts_CNF}/${Package_Configuration_File} |  grep "^PKG_" | awk -F\= '{ print $1 }')
    do
       PKG_LST="'CHANGE ${PKS_versions}=[\${${PKS_versions}}]'  ${PKG_LST}"
done
PKG_LST="'PKG version configuration menu :' ${PKG_LST}"
eval set -A PKG_Version_Menu ${PKG_LST}
#print ${PKG_Version_Menu[@*]}
Menu_Build PKG_Version_Menu
############### Stack_TRACE_BUILDER ################
Function_PATH="$( dirname ${Function_PATH} )"
####################################################
}


function Packages_URL_config
{
#|# Var to set  : None
#|#
#|# Base usage  : Packages_URL_config
#|#
#|# Description : This function is used to create change menu package URL parameter
#|#
#|# Send Back   : Configuration menu
#|#
############ STACK_TRACE_BUILDER #####################
Function_Name="$0"
Function_PATH="${Function_PATH}/${Function_Name}"
######################################################
MSG_DISPLAY "Debug4" "Current Stack : [ ${Function_PATH} ] "
PKS_URLS_INFS_LIST=""
MSG_DISPLAY "Debug5"  "Used Configuration file : [ ${Base_Dir_Scripts_CNF}/${Package_Configuration_File}]"
cat ${Base_Dir_Scripts_CNF}/${Package_Configuration_File} |  grep "^URL_" | awk -F\= '{ print $1 }'
for PKS_URLS_INFS in $( cat ${Base_Dir_Scripts_CNF}/${Package_Configuration_File} |  grep "^URL_" | awk -F\= '{ print $1 }')
    do
       PKS_URLS_INFS_LIST="'CHANGE ${PKS_URLS_INFS}=[\${${PKS_URLS_INFS}}]'  ${PKS_URLS_INFS_LIST}"
done
PKS_URLS_INFS_LIST="'PKG URL configuration menu :' ${PKS_URLS_INFS_LIST}"
eval set -A PKG_URL_Menu_var ${PKS_URLS_INFS_LIST}
Menu_Build PKG_URL_Menu_var

############### Stack_TRACE_BUILDER ################
Function_PATH="$( dirname ${Function_PATH} )"
####################################################
}

Sourced_OK="1"

